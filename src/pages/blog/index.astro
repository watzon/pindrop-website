---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import GlassCard from '../../components/GlassCard.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

const title = "Blog & Changelog";
const description = "Release notes, updates, and announcements for Pindrop.";
---

<Layout title={title} description={description}>
    <div class="relative min-h-screen flex flex-col">
       <div class="fixed top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[600px] bg-brand-orange/10 rounded-full blur-[120px] -z-10 mix-blend-screen opacity-30 pointer-events-none"></div>
       <div class="fixed bottom-0 right-0 w-[800px] h-[600px] bg-brand-pink/10 rounded-full blur-[100px] -z-10 mix-blend-screen opacity-20 pointer-events-none"></div>

       <Header />

       <main class="flex-grow pt-32 pb-20 px-6 md:px-12 max-w-6xl mx-auto w-full">
            <header class="text-center mb-20 space-y-6">
                 <h1 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold text-white leading-[1.1] tracking-tight">
                    Blog & <span class="gradient-text">Changelog</span>
                 </h1>
                 <p class="text-xl text-text-secondary max-w-2xl mx-auto leading-relaxed">
                    Release notes, updates, and announcements.
                 </p>
            </header>

            <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                {posts.map((post) => (
                    <a href={`/blog/${post.id}`} class="group h-full block">
                        <GlassCard class="h-full flex flex-col p-8 hover:bg-white/5 transition-all duration-300 border-white/10 group-hover:border-brand-pink/30 relative overflow-hidden">
                             <!-- Glow effect on hover -->
                             <div class="absolute inset-0 bg-gradient-to-br from-brand-orange/5 to-brand-pink/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                             
                             <div class="relative z-10 flex flex-col h-full">
                                 <div class="flex items-center justify-between mb-4">
                                     <time datetime={post.data.date.toISOString()} class="text-sm text-text-muted font-mono">
                                        {post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
                                     </time>
                                     {post.data.version && (
                                         <span class="px-2 py-0.5 rounded-full bg-brand-pink/10 text-brand-pink border border-brand-pink/20 text-xs font-mono font-medium">
                                             v{post.data.version}
                                         </span>
                                     )}
                                 </div>
                                 
                                 <h2 class="text-2xl font-bold text-white mb-3 group-hover:text-brand-pink transition-colors leading-tight">
                                    {post.data.title}
                                 </h2>
                                 
                                 <p class="text-text-secondary mb-6 flex-grow line-clamp-3 leading-relaxed">
                                    {post.data.description}
                                 </p>
                                 
                                 <div class="flex items-center text-sm font-medium text-brand-pink mt-auto group-hover:text-brand-magenta transition-colors">
                                    Read more <span class="ml-1 transition-transform group-hover:translate-x-1">&rarr;</span>
                                 </div>
                             </div>
                        </GlassCard>
                    </a>
                ))}
            </div>
       </main>

       <Footer />
    </div>
</Layout>
